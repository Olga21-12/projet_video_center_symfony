{% extends 'base.html.twig' %}

{% block title %}Mon Profil{% endblock %}

{% block body %}
<div class="card shadow-sm p-4">
    <div class="row">
        <div class="col-md-3 text-center">
            {% if user.imageName %}
                <img src="{{ asset('uploads/users/' ~ user.imageName) }}" alt="Photo" class="img-fluid rounded-circle mb-3">
            {% else %}
                <img src="{{ asset('image/default-avatar.png') }}" alt="Photo" class="img-fluid rounded-circle mb-3">
            {% endif %}
        </div>
        <div class="col-md-9">
            <h3>{{ user.firstname }} {{ user.lastname }}</h3>
            <p>{{'profile.email'|trans}} {{ user.email }}</p>
            <p>{{'profile.video_count'|trans}} {{ videoCount }}</p>

           {% if popularTypes %}
                <p>{{'profile.popular_types'|trans}} {{ popularTypes|join(', ') }}</p>
            {% endif %}

            <p>{{'profile.member_since'|trans}} {{ user.createdAt|date('d/m/Y') }}</p>

            <div class="d-flex flex-wrap gap-2 mt-3 justify-content-center justify-content-md-start">
                <a href="{{ path('app_profile_edit', {id: user.id}) }}" class="btn btn-warning">
                    {{ 'profile.edit'|trans }}
                </a>

                <form method="post" action="{{ path('app_profile_delete') }}" onsubmit="return confirm('√ätes-vous s√ªr ?');" class="m-0">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ user.id) }}">
                    <button class="btn btn-danger">{{ 'profile.delete_account'|trans }}</button>
                </form>

                <a href="{{ path('app_video_new') }}" class="btn btn-success">{{ 'profile.add_video'|trans }}</a>
        </div>
    </div>
</div>

<hr>

<h4 class="mt-4">{{ 'profile.mesVideos'|trans }} ({{ videoCount }})</h4>
<div class="row">
    {% for video in videos %}
        <div class="col-md-4 mb-3">
            <div class="card h-100">
                <div class="card-body text-center">
                    <iframe width="300" height="200"
                            src="{{ video.videoLink }}"
                            title="{{ video.title }}"
                            frameborder="0"
                            allowfullscreen>
                    </iframe>
                </div>

        <div class="card-body">
            <h5 class="card-title text-truncate">
                <a href="{{ path('app_video_show', {id: video.id}) }}" class="text-decoration-none">
                {{ video.title }}</a>
            </h5>
            
            <p class="card-text text-truncate">{{ video.description }}</p>

            <div class="d-flex justify-content-between align-items-center mt-2">
                <div class="d-flex gap-2">
                    <a href="{{ path('app_video_show', {id: video.id}) }}" class="btn btn-primary btn-sm">
                     {{ 'profile.view'|trans }}
                    </a>
                              
                <a class="btn btn-warning btn-sm" href="{{ path('app_video_edit', {id: video.id}) }}">‚úèÔ∏è</a>
                <a class="btn btn-danger btn-sm" href="{{ path('app_video_delete', {id: video.id}) }}" onclick="return confirm('√ätes-vous s√ªr de vouloir supprimer cette vid√©o ?')">üóë</a>
         
               
               </div>
           

    
    {% if video.premiumVideo %}
        <span class="text-warning fs-5">‚≠ê</span>
    {% endif %}
</div>
 
            <p class="mt-2 text-white small">
                {{ video.createdAt|ago }} ‚Ä¢
                {{ video.user.firstname }}
                <img src="{{ asset(video.user.imageName ? 'uploads/users/' ~ video.user.imageName : 'image/default-avatar.png') }}"
                     alt="{{ video.user.firstname }}"
                     class="rounded-circle me-1"
                     style="width:20px; height:20px; object-fit:cover;">

            </p>
        </div>
        
    </div>
</div>
    {% else %}
        <p>{{ 'profile.no_videos'|trans }}</p>
    {% endfor %}
</div>

<div class="d-flex justify-content-center mt-4">
    {{ knp_pagination_render(videos) }}
</div>


{% endblock %}
